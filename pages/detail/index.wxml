<!--pages/detail/index.wxml-->
<view class="page-container">
  
  <!-- Hero Area é¡¶éƒ¨æ²‰æµ¸åŒº -->
  <view class="hero-area">
    <!-- é¤å…å°é¢å›¾ -->
    <image 
      class="hero-image" 
      src="{{restaurant.coverImage || '/assets/default-cover.jpg'}}" 
      mode="aspectFill"
      lazy-load="{{true}}"
    ></image>
    
    <!-- æ¸å˜é®ç½© -->
    <view class="hero-mask"></view>
    
    <!-- é¤å…åŸºæœ¬ä¿¡æ¯ -->
    <view class="hero-content">
      <text class="restaurant-name">{{restaurant.name || 'åŠ è½½ä¸­...'}}</text>
      <view class="restaurant-meta">
        <view class="meta-item" wx:if="{{restaurant.rating}}">
          <text class="meta-icon">â­</text>
          <text class="meta-text">{{restaurant.rating}}</text>
        </view>
        <view class="meta-item" wx:if="{{restaurant.priceLevel}}">
          <text class="meta-text">{{restaurant.priceLevel}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- Info Sheet æ‚¬æµ®ä¿¡æ¯å¡ -->
  <view class="info-sheet">
    <!-- åœ°å€ -->
    <view class="info-item" wx:if="{{restaurant.address}}" bindtap="onOpenMap">
      <view class="info-icon">ğŸ“</view>
      <view class="info-content">
        <text class="info-text">{{restaurant.address}}</text>
        <text class="info-arrow">â€º</text>
      </view>
    </view>
    
    <!-- è¥ä¸šæ—¶é—´ -->
    <view class="info-item" wx:if="{{restaurant.hours}}">
      <view class="info-icon">ğŸ•</view>
      <view class="info-content">
        <text class="info-text">{{restaurant.hours}}</text>
      </view>
    </view>
    
    <!-- æ ‡ç­¾ -->
    <view class="info-tags" wx:if="{{restaurant.tags && restaurant.tags.length > 0}}">
      <view class="tag" wx:for="{{restaurant.tags}}" wx:key="index">
        {{item}}
      </view>
    </view>
  </view>

  <!-- Section Header èœå“åŒºæ ‡é¢˜ -->
  <view class="section-header">
    <text class="section-title">Menu</text>
    <view class="dish-stats">
      <view class="stat-badge must-try">
        <text class="stat-icon">ğŸ‘</text>
        <text class="stat-count">{{mustTryCount}}</text>
      </view>
      <view class="stat-badge avoid">
        <text class="stat-icon">âš ï¸</text>
        <text class="stat-count">{{avoidCount}}</text>
      </view>
    </view>
  </view>

  <!-- Menu Grid èœå“ç€‘å¸ƒæµ -->
  <view class="menu-grid">
    <view 
      class="dish-card" 
      wx:for="{{dishes}}" 
      wx:key="_id"
      bindtap="onDishTap"
      data-id="{{item._id}}"
    >
      <!-- èœå“å›¾ç‰‡ -->
      <view class="dish-image-wrapper">
        <image 
          class="dish-image" 
          src="{{item.photoUrl || '/assets/default-dish.jpg'}}" 
          mode="aspectFill"
          lazy-load="{{true}}"
        ></image>
        
        <!-- è¯„åˆ†æ ‡è®° -->
        <view class="dish-badge {{item.rating}}">
          <text class="badge-text">
            {{item.rating === 'must-try' ? 'ğŸ‘ å¿…ç‚¹' : 'âš ï¸ é¿å‘'}}
          </text>
        </view>
      </view>
      
      <!-- èœå“ä¿¡æ¯ -->
      <view class="dish-info">
        <text class="dish-name">{{item.name}}</text>
        <text class="dish-note" wx:if="{{item.note}}">{{item.note}}</text>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{dishes.length === 0 && !loading}}">
    <text class="empty-icon">ğŸ½ï¸</text>
    <text class="empty-text">è¿˜æ²¡æœ‰è®°å½•èœå“</text>
    <text class="empty-hint">ç‚¹å‡»ä¸‹æ–¹"æ·»åŠ èœå“"å¼€å§‹è®°å½•</text>
  </view>

  <!-- åº•éƒ¨å ä½ -->
  <view class="bottom-spacer"></view>

  <!-- Action Bar åº•éƒ¨æ“ä½œæ  -->
  <view class="action-bar">
    <view class="action-buttons">
      <!-- åœ°å›¾æŒ‰é’® -->
      <view class="action-btn secondary" bindtap="onOpenMap" wx:if="{{restaurant.location}}">
        <text class="action-icon">ğŸ—ºï¸</text>
      </view>
      
      <!-- åˆ†äº«æŒ‰é’® -->
      <button class="action-btn secondary" open-type="share">
        <text class="action-icon">â†—</text>
      </button>
      
      <!-- ç¼–è¾‘æŒ‰é’® -->
      <view class="action-btn primary" bindtap="onEdit">
        <text class="action-text">ç¼–è¾‘é¤å…</text>
      </view>
      
      <!-- æ·»åŠ èœå“æŒ‰é’® -->
      <view class="action-btn accent" bindtap="onAddDish">
        <text class="action-text">æ·»åŠ èœå“</text>
      </view>
    </view>
  </view>

</view>